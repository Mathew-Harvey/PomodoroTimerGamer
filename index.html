<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sync Pomodoro</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/peerjs/1.4.7/peerjs.min.js"></script>
    <link rel="stylesheet" href="./style.css">
</head>
<body>
    <div class="container">
        <div class="card timer-card">
            <h1>Sync Pomodoro</h1>
            <div class="time-display" id="timeDisplay">25:00</div>
            <div class="status focus" id="statusDisplay">Focus Time</div>
            
            <div class="controls">
                <button id="startBtn">Start</button>
                <button id="resetBtn" class="secondary">Reset</button>
                <button id="syncBtn" class="outlined">Share & Sync</button>
            </div>
            
            <div class="connection-info" id="connectionInfo">
                <div class="connection-status-indicator">
                    <div class="status-dot" id="connectionDot"></div>
                    <div id="connectionStatus">Not connected</div>
                </div>
                <input type="text" id="shareUrl" class="share-url" readonly>
                <button id="reconnectBtn" class="secondary" style="margin-top: 10px; display: none;">Reconnect</button>
            </div>
            
            <div class="timer-settings">
                <div class="setting-group">
                    <div class="setting-label">Focus Duration (min)</div>
                    <input type="number" id="focusDuration" class="setting-input" value="25" min="1" max="60">
                </div>
                <div class="setting-group">
                    <div class="setting-label">Rest Duration (min)</div>
                    <input type="number" id="restDuration" class="setting-input" value="5" min="1" max="30">
                </div>
            </div>
        </div>
        
        <!-- Game Container -->
        <div class="card game-container" id="gameContainer" style="display: none;">
            <div class="game-menu">
                <h2>Select a Game</h2>
                <div class="game-buttons">
                    <button class="game-select-btn" data-game="tictactoe">Tic Tac Toe</button>
                    <button class="game-select-btn" data-game="memory">Memory Game</button>
                    <button class="game-select-btn" data-game="minicraft">MiniCraft</button>
                </div>
            </div>
            <button id="playNowBtn" class="play-now-btn">Play Now</button>
            <!-- Games will be dynamically loaded here by the GameManager -->
        </div>
    </div>
    
    <div class="notification" id="notification">Link copied to clipboard!</div>
    
    <div class="welcome-screen" id="welcomeScreen">
        <div class="welcome-card">
            <h2 class="welcome-title">Welcome to Sync Pomodoro</h2>
            <p class="welcome-subtitle">Focus together, play together. Sync your Pomodoro sessions with friends and enjoy mini-games during breaks.</p>
            <div class="welcome-buttons">
                <button id="createSessionBtn">Create New Session</button>
                <button id="joinSessionBtn" class="secondary">Join Session</button>
            </div>
        </div>
    </div>
    
    <div class="connection-dialog" id="connectionDialog" style="display: none;">
        <div class="connection-card">
            <h2 class="connection-title" id="connectionDialogTitle">Connecting to Session</h2>
            <div class="connection-status" id="connectionDialogStatus">Initializing connection...</div>
            <div class="connection-progress">
                <div class="connection-progress-bar" id="connectionProgressBar"></div>
            </div>
            <div class="connection-error" id="connectionError"></div>
            <div class="welcome-buttons">
                <button id="cancelConnectionBtn" class="secondary">Cancel</button>
                <button id="retryConnectionBtn" class="outlined" style="display: none;">Retry</button>
            </div>
        </div>
    </div>

    <!-- Load game interface first -->
    <script src="./games/game-interface.js"></script>
    
    <!-- Load game instructions helper -->
    <script src="./games/game-instructions.js"></script>
    
    <!-- Load game implementations -->
    <script src="./games/tictactoe.js"></script>
    <script src="./games/memory-game.js"></script>
    <script src="./games/mini-craft.js"></script>
    
    <!-- Load game manager -->
    <script src="./games/game-manager.js"></script>
    
    <!-- Load main application script -->
    <script src="./main.js"></script>
</body>
</html>